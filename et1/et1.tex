\include{settings}

\begin{document}	% начало документа

\include{titlepage}

\section{Задание}

\begin{enumerate}

\item Решить разностное уравнение

\begin{displaymath}
Z[n+2] - 9 \cdot Z[n+1] + 18 \cdot Z[n] = n + 2
\end{displaymath}
\begin{displaymath}
Z[0] = 1
\end{displaymath}
\begin{displaymath}
 Z[1] = 3
\end{displaymath}

\item Осуществить проверку решения для $n = 2$

\end{enumerate}

\section{Решение}

\subsection{Методом неопределённых коэффициентов}

$Z[n] = Z^{o}[n] + Z^{\text{н}}[n]$

$Z[n+2] - 9 \cdot Z[n+1] + 18 \cdot Z[n] = 0$

$Z[n] = c \cdot \lambda^n$

$c \cdot \lambda^{n+2} - 9 \cdot c \cdot \lambda^{n+1} + 18 \cdot c \cdot \lambda^{n} = 0$

$\lambda^2 - 9 \cdot \lambda + 18 = 0$

$\lambda_1 = 3, \ \ \lambda_2 = 6$

$Z^{o}[n] = c_1 \cdot 3^n + c_2 \cdot 6^n$\\[0.3cm]

$Z^{\text{н}}[n] = A \cdot n + B$

$A \cdot (n + 2) + B - 9 \cdot (A \cdot (n + 1) + B) + 18 \cdot (A \cdot n + B) = n + 2$

$10 \cdot A \cdot n - 7 \cdot A + 10 \cdot B = n + 2$

\underline{$A = 0.1$}

$n - 0.7 + 10 \cdot B = n + 2$

\underline{$B = 0.27$}

$Z^{\text{н}}[n] = 0.1 \cdot n + 0.27$\\[0.3cm]

$Z[n] = c_1 \cdot 3^n + c_2 \cdot 6^n +0.1 \cdot n + 0.27$\\[0.3cm]

$
 \begin{cases}
   Z(0) = 1
   \\
   Z(1) = 3
 \end{cases}
$
$
 \begin{cases}
  c_1 + c_2 + 0.27 = 1
   \\
   3 \cdot c_1 + 6 \cdot c_2 + 0.1 + 0.27 = 3
 \end{cases}
$
$
 \begin{cases}
  c_1 = \frac{7}{12}
   \\
   c_2 = \frac{11}{75}
 \end{cases}
$\\[0.5cm]

$Z[n] = \frac{7}{12} \cdot 3^n + \frac{11}{75} \cdot 6^n + 0.1 \cdot n + 0.27$\\[0.5cm]
 

\subsection{Методом Лагранжа}
\
$Z^{\text{н}}[n] = c_1[n] \cdot \lambda_{1}^{n} + c_2[n] \lambda_{2}^{n}$\\[1.5mm]

$Z[n+1] = c_1[n+1] \cdot \lambda_{1}^{n+1} + c_2[n+1] \lambda_{2}^{n+1} \pm c_1[n] \cdot \lambda_{1}^{n+1} \pm c_2[n] \cdot \lambda_{2}^{n+1} =\\[1.5mm] = \underbrace{c_1[n+1] \cdot \lambda_{1}^{n+1} - c_1[n] \cdot \lambda_{1}^{n+1} + c_2[n+1] \lambda_{2}^{n+1} - c_2[n] \cdot \lambda_{2}^{n+1}}_{\bigstar} + \\ + c_1[n] \cdot \lambda_{1}^{n+1} + c_2[n] \cdot \lambda_{2}^{n+1}$\\[1.5mm]

$\bigstar = \Delta c_1[n] \cdot \lambda_1^{n+1} + \Delta c_2[n] \cdot \lambda_2^{n+1} = 0$\\[1.5mm]

$Z[n+1] = c_1[n] \cdot \lambda_1^{n+1} + c_2[n] \cdot \lambda_2^{n+1}$\\[1.5mm]

$Z[n+2] = c_1[n+1] \cdot \lambda_1^{n+2} + c_2[n+1] \cdot \lambda_2^{n+2} \pm c_1[n] \cdot \lambda_1^{n+2} \pm c_2[n] \cdot \lambda_2^{n+2} = \\[1.5mm] = \Delta c_1[n] \cdot \lambda_1^{n+2} + \Delta c_2[n] \cdot \lambda_2^{n+2} + c_1[n] \cdot \lambda_1^{n+2} + c_2[n] \cdot \lambda_2^{n+2} - 9 \cdot c_1[n] \cdot \lambda_1^{n+1} - \\[1.5mm] - 9 \cdot c_2[n] \cdot \lambda_2^{n+1} + 18 \cdot c_1[n] \cdot \lambda_1^{n} + 18 \cdot c_2[n] \cdot \lambda_2^{n} = \Delta c_1[n] \cdot \lambda_1^{n+2} + \Delta c_2[n] \cdot \lambda_2^{n+2} + \\[1.5mm] + c_1[n] \cdot \lambda_1^{n} \cdot \underbrace{\Bigl [\lambda_1^2 - 9 \cdot \lambda_1 + 18 \Bigl ]}_{= \ \ 0} + c_2[n] \cdot \lambda_2^{n} \cdot \underbrace{\Bigl [\lambda_2^2 - 9 \cdot \lambda_2 + 18 \Bigl ]}_{= \ \ 0} $\\[1mm]

$\lambda_1 = 3,\ \ \lambda_2 = 6$\\[1.5mm]

$\Delta c_1[n] \cdot \lambda_1^{n+2} + \Delta c_2[n] \cdot \lambda_2^{n+2} = n + 2 \ \ (\bigstar \bigstar)$\\[1.5mm]

Домножим уравнение $\bigstar$ на $\lambda_2$ и вычтем из уравнения $\bigstar \bigstar$. Аналогично с $\lambda_1$.\\[1.5mm]

$
 \begin{cases}
  \Delta c_1[n] \cdot \lambda_1^{n+1} \cdot (\lambda_1 - \lambda_2) = n + 2
   \\
   \Delta c_2[n] \cdot \lambda_2^{n+1} \cdot (\lambda_1 - \lambda_1) = n + 2
 \end{cases}
$
$
 \begin{cases}
  \Delta c_1[n] = (\frac{1}{\lambda_1})^{n+1} \cdot (n + 2) \cdot \frac{1}{(\lambda_1 - \lambda_2)}  
   \\
   \Delta c_2[n] = (\frac{1}{\lambda_2})^{n+1} \cdot (n + 2) \cdot \frac{1}{(\lambda_2 - \lambda_1)}  
 \end{cases}
$\\[1.5mm]

Рассмотрим\\[1mm]
$\Delta c_1[n] = (\frac{1}{\lambda_1})^{n+1} \cdot (n + 2) \cdot \frac{1}{(\lambda_1 - \lambda_2)} = -\frac{1}{3} \cdot (\frac{1}{3})^{{n+1}} \cdot (n + 2)  = -\frac{1}{9} \cdot (\frac{1}{3})^{n} \cdot (n + 2)$\\[1.5mm]
\begin{displaymath}
c_1[n] = c_1[0] + \sum_{k=0}^{n-1} \Bigl (-\frac{1}{9} \cdot (\frac{1}{3})^{n} \cdot (n + 2) \Bigl ) = c_1[0] -\frac{1}{9} \cdot \sum_{k=0}^{n-1} (\frac{1}{3})^{n} \cdot (n + 2) =
\end{displaymath}

$=  c_1[0] -\frac{1}{9} \cdot S$\\[1mm]

\begin{flalign*}
S = \sum_{k=0}^{n-1} (\frac{1}{3})^{n} \cdot (n + 2)
\end{flalign*}

Воспользуемся формулой Абеля суммирования по частям:

\begin{flalign*}
\sum_{k=p}^{N} u(k+1) \cdot v(k+1) = \Bigl ( \sum_{i=0}^{k} u(i) \Bigl ) \cdot v(k) \Bigl |_{k=p}^{N+1} - \sum_{k=p}^{N} \Bigl ( \sum_{i=0}^{k} u(i) \Bigl ) \cdot \Delta v(k)
\end{flalign*}

$u(k+1) = (\frac{1}{3})^k \Rightarrow u(k) = (\frac{1}{3})^{k-1}$

$v(k+1) = k + 2 \Rightarrow v(k) = k + 1$
\begin{flalign*}
\sum_{i=0}^{k} u(i) = \sum_{i=0}^{k} (\frac{1}{3})^{i-1} = 3 \cdot \sum_{i=0}^{k} (\frac{1}{3})^{i} = 3 \cdot \frac{(\frac{1}{3})^{k+1}-1}{(\frac{1}{3} - 1)} = -\frac{9}{2} \cdot \Bigl ( (\frac{1}{3})^{k+1} - 1 \Bigl )
\end{flalign*}
\begin{flalign*}
S = \sum_{k=0}^{n-1} (\frac{1}{3})^{n} \cdot (n + 2) = -\frac{9}{2} \cdot \Bigl ( (\frac{1}{3})^{k+1} - 1 \Bigl ) (k+1) \Bigl |_{k=0}^{k=n} - \sum_{k=0}^{n-1} \Bigl ( -\frac{9}{2} \Bigl ( (\frac{1}{3})^{k+1} - 1 \Bigl ) \Bigl ) =
\end{flalign*}
\begin{flalign*}
= -\frac{9}{2} \Bigl [ \Bigl ((\frac{1}{3})^{n+1} - 1 \Bigl ) \cdot (n+1) + \frac{2}{3} \Bigl ] + \frac{9}{2} \Bigl [ \frac{1}{3} \cdot \sum_{k=0}^{n-1} (\frac{1}{3})^k + \sum_{k=0}^{n-1} (-1) \Bigl ] = 
\end{flalign*}
\begin{flalign*}
= -\frac{9}{2} \Bigl [ \Bigl ((\frac{1}{3})^{n+1} - 1 \Bigl ) \cdot (n+1) + \frac{2}{3} \Bigl ] + \frac{9}{2} \Bigl [ \frac{1}{3} \cdot \frac{(\frac{1}{3})^n -1}{(\frac{1}{3} - 1)} - n \Bigl ] = 
\end{flalign*}
\begin{flalign*}
= -\frac{9}{2} \Bigl [ \Bigl ((\frac{1}{3})^{n+1} - 1 \Bigl ) \cdot (n+1) + \frac{2}{3} + \frac{1}{2} \cdot \Bigl ((\frac{1}{3})^n -1 \Bigl ) + n \Bigl ]
\end{flalign*}

\begin{flalign*}
c_1[n] = c_1[0] -\frac{1}{9} \cdot S = c_1[0] + \frac{1}{2} \Bigl [ \Bigl ((\frac{1}{3})^{n+1} - 1 \Bigl ) \cdot (n+1) + \frac{2}{3} + \frac{1}{2} \cdot \Bigl ((\frac{1}{3})^n -1 \Bigl ) + n \Bigl ]
\end{flalign*}

После упрощения:
\begin{flalign*}
c_1[n]= c_1[0] -\frac{1}{12} \cdot \Bigl (\frac{1}{3} \Bigl )^n \cdot (5 \cdot 3^n -2 \cdot n - 5)
\end{flalign*}

Аналогично,

\begin{flalign*}
c_2[n]= c_2[0] + \frac{11 \cdot 6^n -5 \cdot n - 11}{75 \cdot 6^n}
\end{flalign*}

\begin{flalign*}
Z[n] = \Bigl (c_1[0] - \frac{1}{12} \Bigl (\frac{1}{3} \Bigl )^n (5 \cdot 3^n -2n - 5) \Bigl ) \cdot 3^n + \Bigl (c_2[0] +  \frac{11 \cdot 6^n -5n - 11}{75 \cdot 6^n} \Bigl ) \cdot 6^n
\end{flalign*}

Найдём $c_1[0]$ и $c_2[0]$, использую начальные условия:\\[1mm]

$Z[0] = c_1[0] + c_2[0] = 1$

$Z[1] = (c_1[0] - \frac{2}{9}) \cdot 3 + (c_2[0] + \frac{1}{9}) \cdot 6 = 3$\\[1.5mm]

Получаем систему:\\[1mm]

$
 \begin{cases}
  c_1[0] + c_2[0] = 1
   \\
   3 \cdot c_1[0] + 6 \cdot c_2[0] = 3
 \end{cases}
$
$
 \begin{cases}
  c_1[0] = 1
   \\
  c_2[0] = 0
 \end{cases}
$

\begin{flalign*}
Z[n] = \Bigl (1 - \frac{1}{12} \Bigl (\frac{1}{3} \Bigl )^n (5 \cdot 3^n -2n - 5) \Bigl ) \cdot 3^n + \Bigl (0 +  \frac{11 \cdot 6^n -5n - 11}{75 \cdot 6^n} \Bigl ) \cdot 6^n
\end{flalign*}

После упрощения:

\begin{flalign*}
Z[n] = \frac{7}{12} \cdot 3^n + \frac{11}{75} \cdot 6^n + 0.1 \cdot n + 0.27
\end{flalign*}


\subsection{Проверка}

С одной стороны,

 $Z[2] =  \frac{7}{12} \cdot 9 + \frac{11}{75} \cdot 36 + 0.2 + 0.27 = 11$

C другой,

 $Z[n+2] = n + 2 + 9 \cdot Z[n+1] - 18 \cdot Z[n] \Rightarrow \\ Z[2] = 2 + 9 \cdot Z[1] - 18 \cdot Z[0] = 2 + 9 \cdot 3 - 18 \cdot 1 = 11$

\end{document}
