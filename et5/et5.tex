\include{settings}

\begin{document}	% начало документа

\include{titlepage}

\section{Задание}

\begin{enumerate}

\item Привести дифференциальное уравнение\\ $y''(t) - 9 \cdot y'(t) + 18 \cdot y(t) = t + 2$\\ к системе дифференциальных уравнений 1-го порядка, решить эту систему аналитически.

\item Привести разностное уравнение\\ $y[n+2] - 9 \cdot y[n+1] + 18 \cdot y[n] = n + 2$\\ к системе разностных уравнений 1-го порядка, решить эту систему аналитически.

\end{enumerate}

\section{Решение}

\subsection{Дифференциальное уравнение}

\begin{displaymath}
y''(t) - 9 \cdot y'(t) + 18 \cdot y(t) = t + 2
\end{displaymath}
\begin{center}
$y(0) = 1,\ \ y'(0) = 3$
\end{center}

Сделаем замены переменных:

$x_1(t) = y(t),\ \ x_2(t) = y'(t) = x_1'(t) \ \ \Rightarrow x_2'(t) = y''(t)$\\[1mm]

Составим систему ДУ первого порядка:

\begin{displaymath}
\begin{cases}
x_1'(t) = 0 \cdot x_1(t) + 1 \cdot x_2(t) + 0
\\
x_2'(t) - 18 \cdot x_1(t) + 9 \cdot x_2(t) + t + 2
\end{cases}
\end{displaymath}

Представим её в матричной форме:
\begin{displaymath}
\begin{pmatrix}
x_1'(t)
\\
x_2'(t)
\end{pmatrix}
=
\begin{pmatrix}
0  & 1
\\
-18 & 9
\end{pmatrix}
\cdot
\begin{pmatrix}
x_1(t)
\\
x_2(t)
\end{pmatrix}
+
\begin{pmatrix}
0
\\
t + 2
\end{pmatrix}
\end{displaymath}
\begin{displaymath}
A = \begin{pmatrix}
0 & 1
\\
-18 & 9
\end{pmatrix}
\end{displaymath}

С учетом начальных условий:
\begin{displaymath}
\begin{pmatrix}
x_1(0)
\\
x_2(0)
\end{pmatrix}
=
\begin{pmatrix}
1
\\
3
\end{pmatrix}
=
x_0
\end{displaymath}
можно определить решение однородной системы $e^{At} \cdot x_0$. Для этого найдем $e^{At}$, воспользовавшись формулой Лагранжа-Сильвестра для матричных функций. А для этого определим собственные числа матрицы $A$:
\begin{displaymath}
\Big | A - \lambda \cdot E \Big | = \Big | \begin{pmatrix}
-\lambda & 1
\\
-18 & 9 - \lambda
\end{pmatrix} \Big | = \lambda^2 - 9 \cdot \lambda + 18 = 0 \ \ \Rightarrow \ \ \lambda_1 = 3,\ \ \lambda_2 = 6
\end{displaymath}

Запишем формулу Лагранжа-Сильвестра для матричной функции $f(A)$ и матрицы размером $2 \times 2$:
\begin{displaymath}
f(A) = T_1 \cdot f(\lambda_1) + T_2 \cdot f(\lambda_2) = \frac{A - \lambda_2 E}{\lambda_1 - \lambda_2} \cdot  f(\lambda_1) + \frac{A - \lambda_1 E}{\lambda_2 - \lambda_1} \cdot f(\lambda_2)
\end{displaymath}
\begin{displaymath}
e^{At} = \frac{A - \lambda_2 E}{\lambda_1 - \lambda_2} \cdot e^{\lambda_1 t} + \frac{A - \lambda_1 E}{\lambda_2 - \lambda_1} \cdot e^{\lambda_2 t}
\end{displaymath}
Подставим полученные $\lambda$:

\begin{displaymath}
e^{At} = \frac{\begin{pmatrix}
0 & 1
\\
-18 & 9
\end{pmatrix} - \begin{pmatrix}
6 & 0
\\
0 & 6
\end{pmatrix}}{3 - 6} \cdot e^{3t} + \frac{\begin{pmatrix}
0 & 1
\\
-18 & 9
\end{pmatrix} - \begin{pmatrix}
3 & 0
\\
0 & 3
\end{pmatrix}}{6 - 3} \cdot e^{6t} = 
\end{displaymath}

\begin{displaymath}
= \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1
\end{pmatrix} \cdot e^{3t} + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot e^{6t}
\end{displaymath}

Теперь определим:
\begin{displaymath}
e^{At} \cdot x_0 = e^{At} \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} = \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1
\end{pmatrix} \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot e^{3t} + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot e^{6t} = 
\end{displaymath} 
\begin{displaymath}
= \begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot e^{3t} +
\begin{pmatrix}
0
\\
0
\end{pmatrix} \cdot e^{6t}
\end{displaymath}

Вычислим значение определённого интеграла:

\begin{displaymath}
\int_0^t e^{A(t - \tau)} \cdot f(\tau) \cdot d \tau = e^{At} \cdot \int_0^t e^{A(-\tau)} \cdot f(\tau) \cdot d \tau =
\end{displaymath}
\begin{displaymath}
= e^{At} \cdot \int_0^t \Big [ \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1
\end{pmatrix} \cdot e^{-3 \tau} + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot e^{-6 \tau} \Big ] \cdot \begin{pmatrix}
0
\\
\tau + 2
\end{pmatrix} \cdot d \tau =
\end{displaymath}
%%
\begin{displaymath}
= e^{At} \cdot \Big [ \int_0^t \begin{pmatrix}
- \frac{1}{3} (\tau + 2)
\\
-(\tau + 2)
\end{pmatrix} \cdot e^{-3 \tau} \cdot d \tau + \int_0^t \begin{pmatrix}
\frac{1}{3} (\tau + 2)
\\
2 (\tau + 2)
\end{pmatrix} \cdot e^{-6 \tau} \cdot d \tau \Big ] = 
\end{displaymath}
%%
\begin{displaymath}
= e^{At} \cdot \Big [  \begin{pmatrix}
- \frac{1}{3}
\\
- 1
\end{pmatrix} \int_0^t (\tau + 2) \cdot e^{-3 \tau} \cdot d \tau + \begin{pmatrix}
\frac{1}{3}
\\
2 
\end{pmatrix} \int_0^t (\tau + 2) \cdot e^{-6 \tau} \cdot d \tau \Big ]
\end{displaymath}
Вычислим по отдельности два интеграла:
\begin{displaymath}
\int_0^t (\tau + 2) \cdot e^{-3 \tau} \cdot d \tau = - \frac{t \cdot e^{-3t}}{3} - \frac{7 \cdot e^{-3t}}{9} + \frac{7}{9}
\end{displaymath}
\begin{displaymath}
\int_0^t (\tau + 2) \cdot e^{-6 \tau} \cdot d \tau = - \frac{t \cdot e^{-6t}}{6} - \frac{13 \cdot e^{-6t}}{36} + \frac{13}{36}
\end{displaymath}

Получим общее решение:

\begin{displaymath}
x(t) =
\begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot e^{3t} + \Big [ \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1
\end{pmatrix} \cdot e^{3t} + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot e^{6t} \Big ] \cdot 
\end{displaymath}
\begin{displaymath}
\cdot \Big [  \begin{pmatrix}
- \frac{1}{3}
\\
- 1
\end{pmatrix} \Big ( - \frac{t \cdot e^{-3t}}{3} - \frac{7 \cdot e^{-3t}}{9} + \frac{7}{9} \Big ) + \begin{pmatrix}
\frac{1}{3}
\\
2 
\end{pmatrix} \Big ( - \frac{t \cdot e^{-6t}}{6} - \frac{13 \cdot e^{-6t}}{36} + \frac{13}{36} \Big) \Big ]
\end{displaymath}
\subsection{Разностное уравнение}

\begin{displaymath}
y[n+2] - 9 \cdot y[n+1] + 18 \cdot y[n] = n + 2
\end{displaymath}
\begin{center}
$y[0] = 1,\ \ y[1] = 3$
\end{center}

Преобразуем исходное уравнение в систему РУ первого порядка с использованием следующей замены переменных:
$z_1[n] = y[n],\ \ z_2[n] = y[n+1],\ \ \Rightarrow z_1[n+1] = y[n+1],\ \ z_2[n+1] = y[n+2]$

Составим систему:
\begin{displaymath}
\begin{cases}
z_1[n+1] = 0 \cdot z_1[n] + 1 \cdot z_2[n] + 0
\\
z_2[n+1] = - 18 \cdot z_1[n] + 9 \cdot z_2[n] + n + 2
\end{cases}
\end{displaymath}
Представим её в матричной форме:
\begin{displaymath}
\begin{pmatrix}
z_1[n+1]
\\
z_2[n+1]
\end{pmatrix} = \begin{pmatrix}
0 & 1
\\
-18 & 9
\end{pmatrix} \cdot \begin{pmatrix}
z_1[n]
\\
z_2[n]
\end{pmatrix} + \begin{pmatrix}
0
\\
n + 2
\end{pmatrix}
\end{displaymath}\\[1mm]
\begin{displaymath}
A = \begin{pmatrix}
0 & 1
\\
-18 & 9
\end{pmatrix}
\end{displaymath}

С учетом начальных условий:
\begin{displaymath}
\begin{pmatrix}
z_1[0]
\\
z_2[0]
\end{pmatrix}
=
\begin{pmatrix}
1
\\
3
\end{pmatrix}
=
z_0
\end{displaymath}
можно определить решение однородной системы $A^n \cdot z_0$. Для этого найдем $A^n$, воспользовавшись формулой Лагранжа-Сильвестра для матричных функций. А для этого опрделим собственные числа матрицы $A$:
\begin{displaymath}
\lambda_1 = 3,\ \ \lambda_2 = 6
\end{displaymath}

Запишем формулу Лагранжа-Сильвестра для матричной функции $f(A) = A^n$ и матрицы размером $2 \times 2$:
\begin{displaymath}
A^n = \frac{A - \lambda_2 E}{\lambda_1 - \lambda_2} \cdot \lambda_1^n + \frac{A - \lambda_1 E}{\lambda_2 - \lambda_1} \cdot \lambda_2^n
\end{displaymath}
\begin{displaymath}
= \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1
\end{pmatrix} \cdot 3^n + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot 6^n
\end{displaymath}

Теперь определим:
\begin{displaymath}
A^n \cdot z_0 = A^n \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} = \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1
\end{pmatrix} \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot 3^n + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot 6^n = 
\end{displaymath} 
\begin{displaymath}
= \begin{pmatrix}
1
\\
3
\end{pmatrix} \cdot 3^n +
\begin{pmatrix}
0
\\
0
\end{pmatrix} \cdot 6^n
\end{displaymath}

Вычислим следующую сумму:

\begin{displaymath}
\sum_{k=0}^{n-1} A^k \cdot f(n-k-1) = \sum_{k=0}^{n-1} \Big [ \begin{pmatrix}
2 & - \frac{1}{3}
\\
6 & -1

\end{pmatrix} \cdot 3^k + \begin{pmatrix}
-1 & \frac{1}{3}
\\
-6 & 2
\end{pmatrix} \cdot 6^k \Big ] \cdot \begin{pmatrix}
0
\\
n-k+1
\end{pmatrix} = 
\end{displaymath}
%%
\begin{displaymath}
= \sum_{k=0}^{n-1} \Big [ 3^k \cdot \begin{pmatrix}
- \frac{1}{3} (n-k+1)
\\
- (n-k+1)
\end{pmatrix} + 6^k \cdot \begin{pmatrix}
\frac{1}{3} (n-k+1)
\\
2 (n-k+1)
\end{pmatrix} \Big ] = 
\end{displaymath}
%%
\begin{displaymath}
= \begin{pmatrix}
- \frac{1}{3}
\\
- 1
\end{pmatrix} \cdot \sum_{k=0}^{n-1} 3^k \cdot (n-k+1)  + \begin{pmatrix}
\frac{1}{3}
\\
2 
\end{pmatrix} \cdot  \sum_{k=0}^{n-1} 6^k \cdot (n-k+1)
\end{displaymath}

Теперь вычислим суммы по отдельности:
\begin{displaymath}
\sum_{k=0}^{n-1} 3^k \cdot (n-k+1) = \frac{5 \cdot 3^n}{4} - \frac{n}{2} - \frac{5}{4}
\end{displaymath}
\begin{displaymath}
\sum_{k=0}^{n-1} 6^k \cdot (n-k+1) = \frac{11 \cdot 6^n}{25} - \frac{n}{5} - \frac{11}{25}
\end{displaymath}

Окончательное решение системы:

\begin{displaymath}
\begin{pmatrix}
z_1[n]
\\
z_2[n]
\end{pmatrix} = 3^n \cdot \begin{pmatrix}
1
\\
3
\end{pmatrix} + \begin{pmatrix}
- \frac{1}{3}
\\
- 1
\end{pmatrix} \cdot \Big ( \frac{5 \cdot 3^n}{4} - \frac{n}{2} - \frac{5}{4} \Big ) + \begin{pmatrix}
\frac{1}{3}
\\
2
\end{pmatrix} \cdot \Big ( \frac{11 \cdot 6^n}{25} - \frac{n}{5} - \frac{11}{25} \Big )
\end{displaymath}

Выполним проверку:\\[1mm]

C одной стороны:\\[1mm]
$y[0] = 1, \ \ y[1] = 3$ (по условию) \\[1mm]
$y[n+2] = n + 2 + 9 \cdot y[n+1] - 18 \cdot y[n] \Rightarrow \\[1mm] y[2] = 2 + 9 \cdot y[1] - 18 \cdot y[0] = 2 + 9 \cdot 3 - 18 \cdot 1 = 11$\\[1mm]

С другой стороны:\\[1mm]
$y[n] = z_1[n] = 3^n -\frac{1}{3} \cdot \Big ( \frac{5 \cdot 3^n}{4} - \frac{n}{2} - \frac{5}{4} \Big ) + \frac{1}{3} \cdot \Big ( \frac{11 \cdot 6^n}{25} - \frac{n}{5} - \frac{11}{25} \Big ) \Rightarrow \\[1mm]
y[0] = 1\\[1mm]
y[1] = 3\\[1mm]
y[2] = 11$

\end{document}
